@model IEnumerable<DaNangSafeMap.Models.Entities.Article>

@{
    ViewData["Title"] = "Trang tin tức Đà Nẵng";
}

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">

<div class="main-wrapper">

    <div class="featured-section">
        <h2 class="featured-title text-center">TIN NỔI BẬT</h2>

        <div class="swiper mySwiper">
            <div class="swiper-wrapper">
                @foreach (var item in Model.Where(a => a.IsFeatured == true && a.Status == 1).OrderByDescending(a => a.CreatedAt))
                {
                    <div class="swiper-slide">
                        <a asp-controller="Article" asp-action="Details" asp-route-id="@item.Id">
                            <div class="featured-card">
                                <img src="@item.ImageUrl" alt="@item.Title">
                                <div class="overlay">
                                    <h3>@item.Title</h3>
                                </div>
                            </div>
                        </a>
                    </div>
                }
            </div>

            <div class="swiper-button-next"></div>
            <div class="swiper-button-prev"></div>
            <div class="swiper-pagination"></div>
        </div>
    </div>

    <div class="content-wrapper">

        <div class="category-block mb-5">
            @{ ViewData["SectionTitle"] = "CẢNH BÁO TỘI PHẠM"; }
            @await Html.PartialAsync("_ArticleSection", Model.Where(a => a.CategoryId == 1 && a.Status == 1))
        </div>

        <div class="category-block mb-5">
            @{ ViewData["SectionTitle"] = "TÌM KIẾM NGƯỜI THÂN"; }
            @await Html.PartialAsync("_ArticleSection", Model.Where(a => a.CategoryId == 2 && a.Status == 1))
        </div>

        <div class="category-block mb-5">
            @{ ViewData["SectionTitle"] = "TIN TỨC XÃ HỘI"; }
            @await Html.PartialAsync("_ArticleSection", Model.Where(a => a.CategoryId == 3 && a.Status == 1))
        </div>

    </div>

</div>

<a asp-controller="Article" asp-action="Create" class="fab-post">
    <i class="bi bi-pencil-square me-2"></i> ĐĂNG TIN
</a>

<script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>

<script>
    var swiper = new Swiper(".mySwiper", {
        loop: true,                 // Vòng lặp vô hạn
        centeredSlides: true,       // Giữ ảnh chính ở giữa
        slidesPerView: "auto",      // Tự động tính toán số lượng slide hiển thị
        spaceBetween: 40,           // Khoảng cách giữa các phần tử
        autoplay: {
            delay: 3000,
            disableOnInteraction: false,
        },
        speed: 800,
        navigation: {
            nextEl: ".swiper-button-next",
            prevEl: ".swiper-button-prev",
        },
        pagination: {
            el: ".swiper-pagination",
            clickable: true,
        },
    });
</script>

<style>
.main-wrapper {
    background: #fff;
}

/* ====== FEATURED UPDATE ====== */
.featured-section {
    margin-bottom: 80px;
    padding: 20px 0;
    overflow: hidden; /* Tránh vỡ layout khi slide phóng to */
}

.featured-title {
    font-weight: 800;
    letter-spacing: 2px;
    color: #1a6e2e;
    margin-bottom: 40px;
}

/* Kích thước mặc định của slide bên cạnh */
.swiper-slide {
    width: 700px !important;
    transition: all 0.5s ease;
    opacity: 0.4;
    transform: scale(0.85); /* Thu nhỏ các slide xung quanh */
}

/* Hiệu ứng khi slide vào giữa (được chọn) */
.swiper-slide-active {
    opacity: 1;
    transform: scale(1.03); /* Phóng to nhẹ slide ở giữa */
    z-index: 10;
}

.featured-card {
    height: 420px;
    border-radius: 20px;
    overflow: hidden;
    position: relative;
    box-shadow: 0 15px 35px rgba(0,0,0,0.15);
}

.featured-card img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.overlay {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    padding: 40px 30px;
    background: linear-gradient(transparent, rgba(0,0,0,0.9));
}

.overlay h3 {
    color: #ffffff;
    font-weight: 800;
    font-size: 1.8rem;
    margin: 0;
}

/* ====== CONTENT ====== */
.content-wrapper {
    margin-left: 5cm;
    margin-right: 5cm;
}

/* ====== FAB ====== */
.fab-post {
    position: fixed;
    bottom: 40px;
    right: 40px;
    background: #007bff;
    color: white !important;
    padding: 16px 28px;
    border-radius: 50px;
    font-weight: bold;
    text-decoration: none;
    box-shadow: 0 6px 20px rgba(0,123,255,0.4);
    z-index: 100;
}

.fab-post:hover {
    background: #0056b3;
    transform: translateY(-3px);
}

/* Custom Swiper Buttons */
.swiper-button-next, .swiper-button-prev {
    color: #1a6e2e;
}

/* Responsive */
@@media (max-width: 992px) {
    .content-wrapper {
        margin-left: 20px;
        margin-right: 20px;
    }

    .swiper-slide {
        width: 320px !important;
    }
    
    .featured-card {
        height: 250px;
    }
}
</style>